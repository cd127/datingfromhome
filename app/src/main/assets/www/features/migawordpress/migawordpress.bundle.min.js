angular.module('starter').controller('MigawordpressViewController',function($scope,$stateParams,Migawordpress,Loader,Dialog,Customer,$cordovaBarcodeScanner,$cordovaClipboard,$ionicHistory,$timeout,$translate,$window,$location,$sce,$state,Application,SB,$cordovaOauth,AUTH_EVENTS){$scope.migawordpress={};$scope.migawordpress.activeurls={};$scope.is_logged_in=Customer.isLoggedIn();$scope.title_styles={};Loader.show();$scope.font_style="";$scope.loadActiveurlconfigsites=function(){$scope.is_loading=!0;Migawordpress.loadActiveurlconfigsites($stateParams.value_id).success(function(data){$scope.migawordpress.activeurls=data.collection;$scope.migawordpress.categories=data.categories;$scope.font_style=data.fontstyle}).error(function onError(data){Dialog.alert('Error',data.message,'OK')}).finally(function(){$scope.is_loading=!1;Loader.hide()})};$scope.login=function(){Customer.loginModal($scope)};$scope.$on(SB.EVENTS.AUTH.loginSuccess,function(){$scope.is_logged_in=!0;$scope.loadActiveurlconfigsites()});$scope.loadContent=function(){Migawordpress.load($stateParams.value_id).success(function(data){$scope.migawordpress=data;if($scope.is_logged_in){$scope.loadActiveurlconfigsites()}}).error(function onError(data){Dialog.alert('Error',data.message,'OK')}).finally(function(){$scope.is_loading=!1;Loader.hide()})};$scope.loginuser=function(tok){Loader.show();url=tok.wp_siteurl;urltrigger="";url=url.replace(/^http:\/\//i,'https://');var user_id=Customer.id;email=Customer.customer.email;migastone_user_id=tok.migastone_user_id.includes(user_id);if(tok.bind_status==0||migastone_user_id==!1){urltrigger=url+'?binduser=true&wp_migstone_auto_login_id='+tok.wp_migstone_auto_login_id+'&migawp_configsite_id='+tok.migawp_configsite_id+'&migastone_user_id='+user_id+'&user_email='+email}else{urltrigger=url+'?migawp_code='+tok.login_token+'&user_email='+email+'&url='+tok.complete_url}
if(tok.userbrowser==1){console.log(urltrigger);window.open(urltrigger,'_system','location=yes')}else{$state.go('migawordpress-iframe',{value_id:$stateParams.value_id,iframe_url:urltrigger,item_key:tok.migawp_configsite_id})}
Loader.hide()};$scope.bindUser=function(tok){var user_id=Customer.id;url=tok.wp_siteurl;url=url.replace(/^http:\/\//i,'https://');request_url=url+'?binduser=true&wp_migstone_auto_login_id='+tok.wp_migstone_auto_login_id+'&migawp_configsite_id='+tok.migawp_configsite_id+'&migastone_user_id='+user_id;window.open(request_url,'_system','location=yes')};$scope.refresh=function(tok){$scope.loadContent()};$scope.showcatitems=function(x){$state.go('migawordpress-categories',{value_id:$stateParams.value_id,cateid:x.migawp_categories_id})};$scope.loadContent()}).controller('MigawordpressIframeController',function($cordovaClipboard,$ionicHistory,$scope,$timeout,$translate,$window,Dialog,$stateParams,$location,$sce,$state,Application,Migawordpress,Loader){$scope.$on("connectionStateChange",function(event,args){if(args.isOnline==!0){$scope.loadContent()}});$scope.is_loading=!0;Loader.show();$scope.main_url="";$scope.loading_spinner_delay=7000;Migawordpress.value_id=$stateParams.value_id;$scope.scan_protocols=["tel:","http:","https:","geo:","smsto:","mailto:","ctc:"];$scope.is_protocol_found=!1;$scope.migaloade={};$scope.migawordpress={"iframe_url":"",};$scope.ios_styles={"height":"100%"};$scope.title_styles={};$scope.is_scanner_opened=!1;$scope.loadContent=function(){Migawordpress.load($stateParams.value_id).success(function(data){$scope.page_title=data.page_title}).error(function onError(data){Dialog.alert('Error',data.message,'OK')});Migawordpress.loaditem($stateParams.item_key).success(function(data){$scope.loading_spinner_delay=data.itemdata[0].spinnerdelay;console.log($scope.loading_spinner_delay)}).error(function onError(data){Dialog.alert('Error',data.message,'OK')});if($stateParams.iframe_url===undefined){$scope.is_loading=!1;Loader.hide();$scope.goToHomePage()}
$scope.main_url=$stateParams.iframe_url;$scope.migawordpress.iframe_url=$sce.trustAsResourceUrl($stateParams.iframe_url);if($scope.iOS()){$scope.ios_styles={"overflow-y":"scroll","-webkit-overflow-scrolling":"touch","height":"100%"}}};$scope.goToFrameMainPage=function(){var current_url=$sce.getTrustedResourceUrl($scope.migawordpress.iframe_url);if(current_url==$scope.main_url){$scope.migawordpress.iframe_url=$sce.trustAsResourceUrl(current_url+' ')}else{$scope.migawordpress.iframe_url=$sce.trustAsResourceUrl($scope.main_url)}};$scope.goToHomePage=function(){$state.go('home')};$scope.iOS=function(){var iDevices=['iPad Simulator','iPhone Simulator','iPod Simulator','iPad','iPhone','iPod'];if(!!navigator.platform){while(iDevices.length){if(navigator.platform===iDevices.pop()){return!0}}}
return!1};window.iframeLoaded=function(){$timeout(function(){$scope.is_loading=!1;Loader.hide()},$scope.loading_spinner_delay)}
$scope.loadContent()}).controller('MigawordpressCategoriesController',function($scope,$stateParams,Migawordpress,Loader,Dialog,Customer,$cordovaBarcodeScanner,$cordovaClipboard,$ionicHistory,$timeout,$translate,$window,$location,$sce,$state,Application,SB,$cordovaOauth,AUTH_EVENTS){$scope.migawordpress={};$scope.migawordpress.activeurls={};$scope.title_styles={};$scope.is_logged_in=Customer.isLoggedIn();Loader.show();$scope.loadActiveurlconfigsites=function(){console.log("Method called");$scope.is_loading=!0;Migawordpress.getallconfigureurlspercat($stateParams.value_id,$stateParams.cateid).success(function(data){$scope.migawordpress.activeurls=data.collection;$scope.migawordpress.categories=data.categories;console.log("Loaded Collections");console.log(data);console.log($scope.migawordpress.activeurls)}).error(function onError(data){Dialog.alert('Error',data.message,'OK')}).finally(function(){$scope.is_loading=!1;Loader.hide()})};$scope.login=function(){Customer.loginModal($scope)};$scope.$on(SB.EVENTS.AUTH.loginSuccess,function(){$scope.is_logged_in=!0;$scope.loadActiveurlconfigsites()});$scope.loadContent=function(){Migawordpress.load($stateParams.value_id).success(function(data){$scope.migawordpress=data;if($scope.is_logged_in){console.log("i just call the method");$scope.loadActiveurlconfigsites()}}).error(function onError(data){Dialog.alert('Error',data.message,'OK')}).finally(function(){$scope.is_loading=!1;Loader.hide()})};$scope.loginuser=function(tok){Loader.show();url=tok.wp_siteurl;urltrigger="";url=url.replace(/^http:\/\//i,'https://');var user_id=Customer.id;email=Customer.customer.email;migastone_user_id=tok.migastone_user_id.includes(user_id);if(tok.bind_status==0||migastone_user_id==!1){urltrigger=url+'?binduser=true&wp_migstone_auto_login_id='+tok.wp_migstone_auto_login_id+'&migawp_configsite_id='+tok.migawp_configsite_id+'&migastone_user_id='+user_id+'&user_email='+email}else{urltrigger=url+'?migawp_code='+tok.login_token+'&user_email='+email+'&url='+tok.complete_url}
if(tok.userbrowser==1){console.log(urltrigger);window.open(urltrigger,'_system','location=yes')}else{$state.go('migawordpress-iframe',{value_id:$stateParams.value_id,iframe_url:urltrigger,item_key:tok.migawp_configsite_id})}
Loader.hide()};$scope.bindUser=function(tok){var user_id=Customer.id;url=tok.wp_siteurl;url=url.replace(/^http:\/\//i,'https://');request_url=url+'?binduser=true&wp_migstone_auto_login_id='+tok.wp_migstone_auto_login_id+'&migawp_configsite_id='+tok.migawp_configsite_id+'&migastone_user_id='+user_id;window.open(request_url,'_system','location=yes')};$scope.refresh=function(tok){$scope.loadContent()};$scope.showcatitems=function(x){$state.go('migawordpress-categories',{value_id:$stateParams.value_id,cateid:x.migawp_categories_id})};$scope.loadContent()});angular.module('starter').factory('Migawordpress',function($rootScope,$http,Url){var factory={};factory.value_id=null;factory.load=function(value_id){if(!value_id)return;return $http({method:'GET',url:Url.get("migawordpress/mobile_view/load",{value_id:value_id}),cache:!1,responseType:'json'})};factory.loadActiveurlconfigsites=function(value_id){if(!value_id)return;return $http({method:'GET',url:Url.get("migawordpress/mobile_view/loadactiveurlconfigsites",{value_id:value_id}),cache:!1,responseType:'json'})};factory.getallconfigureurlspercat=function(value_id,catid){if(!value_id)return;return $http({method:'GET',url:Url.get("migawordpress/mobile_view/getallconfigureurlspercat",{value_id:value_id,catid:catid}),cache:!1,responseType:'json'})};factory.loaditem=function(migawp_configsite_id){if(!migawp_configsite_id)return;return $http({method:'GET',url:Url.get("migawordpress/mobile_view/loaditem",{id:migawp_configsite_id}),cache:!1,responseType:'json'})};return factory});Features.insertCSS(":root{--safe-area-inset-top:0;--safe-area-inset-right:0;--safe-area-inset-bottom:0;--safe-area-inset-left:0}@supports (padding-top:constant(safe-area-inset-top)){:root{--safe-area-inset-top:constant(safe-area-inset-top);--safe-area-inset-right:constant(safe-area-inset-right);--safe-area-inset-bottom:constant(safe-area-inset-bottom);--safe-area-inset-left:constant(safe-area-inset-left)}}@supports (padding-top:env(safe-area-inset-top)){:root{--safe-area-inset-top:env(safe-area-inset-top);--safe-area-inset-right:env(safe-area-inset-right);--safe-area-inset-bottom:env(safe-area-inset-bottom);--safe-area-inset-left:env(safe-area-inset-left)}}.platform-overview.platform-cordova{--safe-area-inset-top:1.5em;--safe-area-inset-right:0;--safe-area-inset-bottom:.5em;--safe-area-inset-left:0}.migawordpress-module .icon-place{margin-left:5px}.migawordpress-module .list-button-poistion{margin-top:8px;float:right}","migawordpress")