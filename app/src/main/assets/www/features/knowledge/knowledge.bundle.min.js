angular.module('starter').controller('KnowledgeListController',function($ionicModal,$ionicScrollDelegate,$rootScope,$state,$stateParams,$scope,$translate,$timeout,$filter,Customer,Knowledge,Dialog,AUTH_EVENTS){angular.extend($scope,{is_loading:!0,is_logged_in:Customer.isLoggedIn(),value_id:$stateParams.value_id,collection:[],recentCollection:[],can_load_older_posts:!0,can_load_newer_posts:!0,page_title:'',my_avatar_url:null,show_search:!1,show_questionBox:!1,search:'',searching:!1,customer_name:null,knowledgeListStyle:{},knowledgeSearchStyle:{top:'40px'},tag_id:Knowledge.get('tag_id')});Knowledge.value_id=$stateParams.value_id;var searchChanged;$scope.$on('$ionicView.beforeEnter',function(){if(Knowledge.get('tag_id')){Knowledge.delete('tag_id')}
$scope.tag_id=Knowledge.get('tag_id')});$scope.clearSearch=function(){if($scope.search){$scope.search='';$scope.searching=!0;$scope.collection=[];$timeout(function(){$scope.loadContent()},1000)}};$scope.searchTag=function(tag_id,tagChanged){if(!tag_id){Knowledge.delete('tag_id')}else{Knowledge.set('tag_id',tag_id)}
if(!tagChanged){if($scope.show_search){$scope.showPinItem('search')}
$scope.tag_id=Knowledge.get('tag_id');$scope.searching=!0;$scope.collection=[];$timeout(function(){$scope.loadContent()},1000)}};$scope.searchFunc=function(){$scope.searching=!0;$scope.tag_id=Knowledge.get('tag_id');$scope.collection=[];$timeout(function(){$scope.loadContent()},1000)};$scope.clearTag=function(all){if(all==='all'){$scope.search=''}
if($scope.show_search){$scope.showPinItem('search')}
$scope.searching=!0;Knowledge.delete('tag_id');$scope.tag_id=Knowledge.get('tag_id');$scope.collection=[];$timeout(function(){$scope.loadContent()},1000)};$scope.searchQuestions=function(te){if(searchChanged){$timeout.cancel(searchChanged)}
searchChanged=$timeout(function(){$scope.search=te.target.value;$scope.searching=!0;$scope.collection=[];$timeout(function(){$scope.loadContent()},1000)},1000)};$scope.showPinItem=function(item){if(item==='search'){if($scope.show_questionBox){$scope.show_questionBox=!1;$scope.show_search=!0}else if($scope.show_search){$scope.show_search=!1;$timeout(function(){$scope.knowledgeListStyle.marginTop='0'},100)}else{$scope.show_search=!0}
if($scope.show_search){$timeout(function(){var searchBox=document.getElementById('search-box');$scope.knowledgeListStyle.marginTop=(searchBox.offsetHeight+10)+'px'},100)}}else if(item==='q_box'){if($scope.show_search){$scope.show_search=!1;$scope.show_questionBox=!0}else if($scope.show_questionBox){$scope.show_questionBox=!1;$timeout(function(){$scope.knowledgeListStyle.marginTop='0'},100)}else{$scope.show_questionBox=!0}
if($scope.show_questionBox){$timeout(function(){var questionBox=document.getElementById('question-box');$scope.knowledgeListStyle.marginTop=(questionBox.offsetHeight+10)+'px'},100)}}else{$scope.show_search=!1;$scope.show_questionBox=!1}
$timeout(function(){var x=document.getElementsByTagName('ion-header-bar')[0].offsetHeight;$scope.knowledgeSearchStyle.top=x+'px'},100)};$scope.getText=function(text){return $filter('limitcharacter')(text,100)};$scope.goToTagPost=function(post_id,add){console.log(post_id);console.log(add);if(post_id&&add){$state.go('knowledge-answer',{value_id:$scope.value_id,post_id:post_id,edit_id:!1,answer_id:!1,reply_id:!1,first_level:!1})}else if(post_id){$state.go('knowledge-view',{value_id:$scope.value_id,post_id:post_id})}};$scope.newPost=function(edit_id){var localEditId=edit_id;if(!$scope.is_logged_in){$scope.$on(AUTH_EVENTS.loginSuccess,function(){$state.reload()});Customer.loginModal($scope);return}
if(!localEditId){localEditId=!1}
$state.go('knowledge-edit',{value_id:$scope.value_id,edit_id:localEditId})};$scope.loadMore=function(){$scope.loadContent()};$scope.filterCollection=function(collection){var x=[];for(var i=collection.length-1;i>=0;i--){if(collection[i].id!=$scope.collection[i].id){x[i]=collection[i].id;var index=$scope.collection.findIndex(function(x){return x.id==collection[i].id});if(index>-1){$scope.collection.splice(index,1);$scope.collection.unshift(collection[i])}}}
return x};$scope.pullMore=ionic.debounce(function(top){if($ionicScrollDelegate.getScrollPosition().top<=top&&$scope.collection.length){if($scope.can_load_newer_posts){$scope.can_load_newer_posts=!1;$timeout(function(){$scope.can_load_newer_posts=!0},10000);var loggedIn=!1;if(Customer.isLoggedIn()){loggedIn=!0}
Knowledge.findAll(0,loggedIn).then(function(data){if(data.collection){$scope.filterCollection(data.collection);var props=['id'];var result=data.collection.filter(function(o1){return!$scope.collection.some(function(o2){return o1.id===o2.id})}).map(function(o){return props.reduce(function(newo,name){newo=o;return newo},{})});if(result.length){for(var i=result.length-1;i>=0;i--){$scope.collection.unshift(result[i])}}else{console.log('Old object')}}}).then(function(){$scope.is_loading=!1})}}
$scope.$broadcast('scroll.refreshComplete');$rootScope.$broadcast('refreshPageSize')},100);$scope.loadContent=function(){Customer.find().then(function(data){if(data&&data.id){$scope.my_avatar_url=Customer.getAvatarUrl(data.id);$scope.customer_name=data.firstname+' '+data.lastname}},function(e){console.log(e)});Knowledge.findAll($scope.collection.length,$scope.search).then(function(data){if(data.page_title){$scope.page_title=data.page_title}
$scope.can_load_older_posts=!!data.collection.length;$scope.collection=$scope.collection.concat(data.collection);$scope.recentCollection=$scope.collection;$rootScope.$broadcast('refreshPageSize')},function(){$scope.can_load_older_posts=!1;$scope.is_loading=!1;$scope.searching=!1}).then(function(){Knowledge.findAllTags().then(function(data){$scope.tags=data.collection},function(){$scope.is_loading=!1}).then(function(){$scope.is_loading=!1});if($scope.searching){$scope.searching=!1;$ionicScrollDelegate.scrollTop()}
$scope.$broadcast('scroll.infiniteScrollComplete')})};$scope.loadContent()}).controller('KnowledgeEditController',function($ionicHistory,$stateParams,$scope,$state,$translate,Customer,Knowledge,$timeout,Dialog,AUTH_EVENTS,$cordovaCamera,$ionicActionSheet,Application){angular.extend($scope,{is_loading:!0,is_logged_in:Customer.isLoggedIn(),value_id:$stateParams.value_id,post_id:$stateParams.edit_id,page_title:$translate.instant('New question'),tags:[],tags_disabled:!1,new_post:{text:null,tagged_id:{}}});Knowledge.value_id=$stateParams.value_id;Knowledge.post_id=$stateParams.edit_id;if($scope.post_id){$scope.page_title=$translate.instant('Edit question')}
$scope.tagButton=function(tag_id){if(!tag_id){return!1}
if($scope.new_post.tagged_id[tag_id]==tag_id){delete $scope.new_post.tagged_id[tag_id];$scope.tags_disabled=!1}else{$scope.new_post.tagged_id[tag_id]=tag_id}
if(Object.keys($scope.new_post.tagged_id).length>=3){$scope.tags_disabled=!0;return}};$scope.sendPost=function(){$scope.is_loading=!0;if(!$scope.is_logged_in){$scope.$on(AUTH_EVENTS.loginSuccess,function(){$scope.is_logged_in=!0;$scope.sendPost()});Customer.loginModal($scope);$ionicHistory.goBack();return}
if(!$scope.new_post.text){Dialog.alert('Error',$translate.instant('Please add your question in the textbox.'),'OK');$scope.is_loading=!1;return}
if($scope.new_post.oldText==$scope.new_post.text&&$scope.new_post.oldImage==$scope.new_post.image){Dialog.alert('Error',$translate.instant('Please update your answer.'),'OK');$scope.is_loading=!1;return}
Knowledge.sendPost($scope.new_post).then(function(data){$ionicHistory.goBack()},function(){$scope.is_loading=!1}).then(function(){$scope.is_loading=!1})};$scope.loadContent=function(){Customer.find().then(function(data){if(data&&data.id){$scope.my_avatar_url=Customer.getAvatarUrl(data.id);$scope.customer_name=data.firstname+' '+data.lastname}},function(e){console.log(e)});Knowledge.findAllTags().then(function(data){$scope.tags=data.collection},function(){$scope.is_loading=!1}).then(function(){$scope.is_loading=!1;if($scope.post_id){Knowledge.findPost().then(function(data){$timeout(function(){$scope.new_post.text=data.title;$scope.new_post.image=data.image;$scope.new_post.oldText=data.title;$scope.new_post.oldImage=data.image;angular.forEach(data.tagged_id,function(value,key){$scope.new_post.tagged_id[value.tag_id]=value.tag_id});if(Object.keys($scope.new_post.tagged_id).length>=3){$scope.tags_disabled=!0}})},function(){$scope.is_loading=!1}).then(function(){$scope.is_loading=!1})}})};$scope.addImage=function(){$scope.imageToSend=null;var gotError=function(err){};if(Application.is_webview){var input=angular.element("<input type='file' accept='image/*'>");var selectedFile=function(evt){var file=evt.currentTarget.files[0];var reader=new FileReader();reader.onload=function(evt){$timeout(function(){$scope.new_post.image=evt.target.result},0);input.off("change",selectedFile)};reader.onerror=gotError;reader.readAsDataURL(file)};input.on("change",selectedFile);input[0].click()}else{var source_type=Camera.PictureSourceType.CAMERA;var hideSheet=$ionicActionSheet.show({buttons:[{text:'<i class="icon ion-camera"></i>'+$translate.instant("Take a picture")},{text:'<i class="icon ion-folder"></i>'+$translate.instant("Import from Library")},],cancelText:'<i class="icon ion-close"></i>'+$translate.instant("Cancel"),cancel:function(){hideSheet()},buttonClicked:function(index){if(index==0){source_type=Camera.PictureSourceType.CAMERA}
if(index==1){source_type=Camera.PictureSourceType.PHOTOLIBRARY}
if(index==1||index==0){var options={quality:90,destinationType:Camera.DestinationType.DATA_URL,sourceType:source_type,encodingType:Camera.EncodingType.JPEG,targetWidth:1200,targetHeight:1200,correctOrientation:!0,popoverOptions:CameraPopoverOptions,saveToPhotoAlbum:!1};$cordovaCamera.getPicture(options).then(function(imageData){if(imageData){$scope.new_post.image="data:image/jpeg;base64,"+imageData}},gotError)}
return!0}})}}
$scope.loadContent()}).controller('KnowledgeViewController',function($rootScope,$stateParams,$scope,$state,$translate,$filter,Customer,Knowledge,Dialog){angular.extend($scope,{is_loading:!0,is_logged_in:Customer.isLoggedIn(),value_id:$stateParams.value_id,post_id:$stateParams.post_id,collection:[],answers:[],can_load_older_posts:!0,});Knowledge.value_id=$stateParams.value_id;Knowledge.post_id=$stateParams.post_id;$scope.loadMoreAnswers=function(){Knowledge.loadMoreAnswers($scope.answers.length).then(function(data){$scope.can_load_older_posts=!!data.answers.length;$scope.answers=$scope.answers.concat(data.answers);$rootScope.$broadcast('refreshPageSize')},function(){$scope.can_load_older_posts=!1;$scope.is_loading=!1}).then(function(){$scope.is_loading=!1;$scope.$broadcast('scroll.infiniteScrollComplete')})};$scope.loadMore=function(){$scope.loadMoreAnswers()};$scope.goToBack=function(){$state.go('knowledge-list',{value_id:$scope.value_id,tag_id:!1})};$scope.addAnswer=function(edit_id){if(!edit_id){edit_id=!1}
$state.go('knowledge-answer',{value_id:$scope.value_id,post_id:$scope.post_id,edit_id:edit_id,answer_id:!1,reply_id:!1})};$scope.deleteAnswer=function(delete_id){if(!delete_id){return}
Dialog.confirm($translate.instant('Please confirm'),$translate.instant('Are you sure you want delete this answer?'),['Yes','No']).then(function(result){if(result){$scope.is_loading=!0;Knowledge.deleteAnswer(delete_id).then(function(data){if(data.success){$state.reload()}},function(data){$scope.showError(data)}).then(function(){$scope.is_loading=!1})}})};$scope.getText=function(text){return $filter('limitcharacter')(text,100)};$scope.replyAnswer=function(answer_id,reply_id){if(!answer_id){return}
if(!reply_id){reply_id=!1}
$state.go('knowledge-answer',{value_id:$scope.value_id,post_id:$scope.post_id,edit_id:!1,answer_id:answer_id,reply_id:reply_id,first_level:!0})};$scope.goToReply=function(comment_id){if(!comment_id){return}
$state.go('knowledge-reply',{value_id:$scope.value_id,post_id:$scope.post_id,comment_id:comment_id,first_level:!0})};$scope.addLike=function(){Knowledge.addLike().then(function(data){if(data.success){$scope.collection.details.likes.text++;$scope.collection.details.likes.has_own=!0}else if(data.deleted){$scope.collection.details.likes.text--;$scope.collection.details.likes.has_own=!1}},function(data){$scope.showError(data)})};$scope.editPost=function(post_id){if(!post_id){return}
$state.go('knowledge-edit',{value_id:$scope.value_id,edit_id:post_id})};$scope.deletePost=function(post_id){if(!post_id){return}
Dialog.confirm($translate.instant('Please confirm'),$translate.instant('Are you sure you want delete this post?'),['Yes','No']).then(function(result){if(result){$scope.is_loading=!0;Knowledge.deletePost(post_id).then(function(data){if(data.success){$state.go('knowledge-list',{value_id:$scope.value_id})}},function(data){$scope.showError(data)}).then(function(){$scope.is_loading=!1})}})};$scope.showError=function(data){if(data&&angular.isDefined(data.message)){Dialog.alert('Error',data.message,'OK')}};$scope.loadContent=function(){Knowledge.findPost().then(function(data){console.log(data);if(data.page_title){$scope.page_title=data.page_title}
if(data.notification_status){$scope.notification_status=data.notification_status}
$scope.collection=data;$scope.loadMoreAnswers()},function(){$scope.is_loading=!1}).then(function(){$scope.is_loading=!1})};$scope.loadContent();$scope.postStatus=function(){$scope.notification_status=($scope.notification_status==0)?1:0;console.log($scope.notification_status);Knowledge.sendPostStatus($scope.notification_status,$scope.post_id).then(function(data){},function(){$scope.is_loading=!1}).then(function(){$scope.is_loading=!1})}}).controller('KnowledgeAnswerController',function($ionicHistory,$rootScope,$stateParams,$scope,$state,$translate,$timeout,Customer,Knowledge,Dialog,AUTH_EVENTS,$cordovaCamera,$ionicActionSheet,Application){angular.extend($scope,{is_loading:!0,is_logged_in:Customer.isLoggedIn(),value_id:$stateParams.value_id,post_id:$stateParams.post_id,edit_id:$stateParams.edit_id,reply_id:$stateParams.reply_id,answer_id:$stateParams.answer_id,first_level:$stateParams.first_level,new_post:{text:null,oldText:null}});Knowledge.value_id=$stateParams.value_id;Knowledge.post_id=$stateParams.post_id;Knowledge.edit_id=$stateParams.edit_id;Knowledge.reply_id=$stateParams.reply_id;Knowledge.answer_id=$stateParams.answer_id;Knowledge.first_level=$stateParams.first_level;$scope.page_title=($scope.answer_id!='false')?$translate.instant('Add reply'):$translate.instant('Add answer');$scope.loadContent=function(){Knowledge.findAnswer().then(function(data){if(data&&data.text){$scope.new_post.text=data.text;$scope.new_post.oldText=data.text;$scope.new_post.image=data.image;$scope.new_post.oldImage=data.image}},function(){$scope.is_loading=!1}).then(function(){$scope.is_loading=!1})};if($scope.edit_id){$scope.loadContent()}else{$timeout(function(){$scope.is_loading=!1},1000)}
$scope.sendAnswer=function(){$scope.is_loading=!0;if(!$scope.is_logged_in){$scope.$on(AUTH_EVENTS.loginSuccess,function(){$scope.is_logged_in=!0;$scope.sendAnswer()});$ionicHistory.goBack();Customer.loginModal($scope);return}
if(!$scope.new_post.text){Dialog.alert('Error',$translate.instant('Please add your answer in the textbox.'),'OK');$scope.is_loading=!1;return}
if($scope.new_post.oldText==$scope.new_post.text&&$scope.new_post.oldImage==$scope.new_post.image){Dialog.alert('Error',$translate.instant('Please update your answer.'),'OK');$scope.is_loading=!1;return}
Knowledge.sendAnswer($scope.new_post).then(function(data){$ionicHistory.goBack()},function(){$scope.is_loading=!1}).then(function(){$scope.is_loading=!1})};$scope.addImage=function(){$scope.imageToSend=null;var gotError=function(err){};if(Application.is_webview){var input=angular.element("<input type='file' accept='image/*'>");var selectedFile=function(evt){var file=evt.currentTarget.files[0];var reader=new FileReader();reader.onload=function(evt){$timeout(function(){$scope.new_post.image=evt.target.result},0);input.off("change",selectedFile)};reader.onerror=gotError;reader.readAsDataURL(file)};input.on("change",selectedFile);input[0].click()}else{var source_type=Camera.PictureSourceType.CAMERA;var hideSheet=$ionicActionSheet.show({buttons:[{text:'<i class="icon ion-camera"></i>'+$translate.instant("Take a picture")},{text:'<i class="icon ion-folder"></i>'+$translate.instant("Import from Library")},],cancelText:'<i class="icon ion-close"></i>'+$translate.instant("Cancel"),cancel:function(){hideSheet()},buttonClicked:function(index){if(index==0){source_type=Camera.PictureSourceType.CAMERA}
if(index==1){source_type=Camera.PictureSourceType.PHOTOLIBRARY}
if(index==1||index==0){var options={quality:90,destinationType:Camera.DestinationType.DATA_URL,sourceType:source_type,encodingType:Camera.EncodingType.JPEG,targetWidth:1200,targetHeight:1200,correctOrientation:!0,popoverOptions:CameraPopoverOptions,saveToPhotoAlbum:!1};$cordovaCamera.getPicture(options).then(function(imageData){if(imageData){$scope.new_post.image="data:image/jpeg;base64,"+imageData}},gotError)}
return!0}})}}}).controller('KnowledgeReplyController',function($ionicHistory,$rootScope,$stateParams,$scope,$state,$translate,$timeout,$filter,Customer,Knowledge,Dialog){angular.extend($scope,{is_loading:!0,is_logged_in:Customer.isLoggedIn(),value_id:$stateParams.value_id,post_id:$stateParams.post_id,comment_id:$stateParams.comment_id,first_level:$stateParams.first_level,collection:[],replies:[],can_load_older_posts:!0,page_title:$translate.instant('Replies')});Knowledge.value_id=$stateParams.value_id;Knowledge.post_id=$stateParams.post_id;Knowledge.comment_id=$stateParams.comment_id;Knowledge.first_level=$stateParams.first_level;$scope.loadMoreReplies=function(){Knowledge.loadMoreReplies($scope.replies.length).then(function(data){$scope.can_load_older_posts=!!data.replies.length;$scope.replies=$scope.replies.concat(data.replies);$rootScope.$broadcast('refreshPageSize')},function(){$scope.can_load_older_posts=!1;$scope.is_loading=!1}).then(function(){$scope.is_loading=!1;$scope.$broadcast('scroll.infiniteScrollComplete')})};$scope.loadMore=function(){$scope.loadMoreReplies()};$scope.addReplyToComment=function(reply_id){if(!reply_id){reply_id=!1}
$state.go('knowledge-answer',{value_id:$scope.value_id,post_id:$scope.post_id,edit_id:!1,answer_id:$scope.comment_id,reply_id:reply_id,first_level:$scope.first_level})};$scope.addReplyToReply=function(reply_id,reply_reply_id){if(!reply_id){return}
if(!reply_reply_id){reply_reply_id=!1}
$state.go('knowledge-answer',{value_id:$scope.value_id,post_id:$scope.post_id,edit_id:!1,answer_id:reply_id,reply_id:reply_reply_id,first_level:!1})};$scope.deleteReply=function(delete_id){if(!delete_id){return}
Dialog.confirm($translate.instant('Please confirm'),$translate.instant('Are you sure you want delete this answer?'),['Yes','No']).then(function(result){if(result){$scope.is_loading=!0;Knowledge.deleteReply(delete_id).then(function(data){if(data.success){$state.reload()}},function(data){$scope.showError(data)}).then(function(){$scope.is_loading=!1})}})};$scope.addLike=function(){Knowledge.addReplyLike().then(function(data){if(data.success){$scope.collection.details.likes.text++;$scope.collection.details.likes.has_own=!0}else if(data.deleted){$scope.collection.details.likes.text--;$scope.collection.details.likes.has_own=!1}},function(data){$scope.showError(data)})};$scope.goToReply=function(comment_id){if(!comment_id){return}
$state.go('knowledge-reply',{value_id:$scope.value_id,post_id:$scope.post_id,comment_id:comment_id,first_level:!1})};$scope.showError=function(data){if(data&&angular.isDefined(data.message)){Dialog.alert('Error',data.message,'OK')}};$scope.getText=function(text){return $filter('limitcharacter')(text,100)};$scope.loadContent=function(){Knowledge.findComment().then(function(data){$scope.collection=data;$scope.loadMoreReplies()},function(){$scope.is_loading=!1}).then(function(){$scope.is_loading=!1})};$scope.loadContent()});angular.module('starter').factory('Knowledge',function($pwaRequest,$window){var factory={};factory.value_id=null;factory.displayed_per_page=null;factory.findAll=function(offset,search){if(!this.value_id){return $pwaRequest.reject('Missing value_id.')}
var tag_id=this.get('tag_id');var params={};if(tag_id&&(!search||search===!0)){params={value_id:this.value_id,offset:offset,tag_id:tag_id}}else if(tag_id&&search){params={value_id:this.value_id,offset:offset,search:search,tag_id:tag_id}}else if(!tag_id&&search){params={value_id:this.value_id,offset:offset,search:search}}else{params={value_id:this.value_id,offset:offset}}
return $pwaRequest.get('knowledge/mobile_list/findall',{urlParams:params,cache:!1})};factory.findAllTags=function(){if(!this.value_id){return $pwaRequest.reject('Missing value_id.')}
return $pwaRequest.get('knowledge/mobile_edit/findall',{urlParams:{value_id:this.value_id},cache:!1})};factory.sendPost=function(posted_data){if(!this.value_id){return $pwaRequest.reject('Missing value_id.')}
var data={value_id:this.value_id,post_id:this.post_id,posted_data:posted_data};return $pwaRequest.post('knowledge/mobile_edit/sendpost',{data:data,cache:!1})};factory.findPost=function(){if(!this.value_id||!this.post_id){return $pwaRequest.reject('Missing value_id or post_id.')}
var params={value_id:this.value_id,post_id:this.post_id};return $pwaRequest.get('knowledge/mobile_view/findpost',{urlParams:params,cache:!1})};factory.loadMoreAnswers=function(offset){if(!this.value_id||!this.post_id){return $pwaRequest.reject('Missing value_id or post_id.')}
var params={value_id:this.value_id,post_id:this.post_id,offset:offset};return $pwaRequest.get('knowledge/mobile_view/findanswers',{urlParams:params,cache:!1})};factory.findAnswer=function(){if(!this.value_id||!this.edit_id){return $pwaRequest.reject('Missing value_id or edit_id.')}
var params={value_id:this.value_id,edit_id:this.edit_id,answer_id:this.answer_id,reply_id:this.reply_id};return $pwaRequest.get('knowledge/mobile_view/findanswer',{urlParams:params,cache:!1})};factory.findComment=function(){if(!this.value_id||!this.comment_id){return $pwaRequest.reject('Missing value_id or comment_id.')}
var params={value_id:this.value_id,comment_id:this.comment_id,first_level:this.first_level};return $pwaRequest.get('knowledge/mobile_view/findcomment',{urlParams:params,cache:!1})};factory.loadMoreReplies=function(offset){if(!this.value_id||!this.comment_id){return $pwaRequest.reject('Missing value_id or comment_id.')}
var params={value_id:this.value_id,comment_id:this.comment_id,first_level:this.first_level,offset:offset};return $pwaRequest.get('knowledge/mobile_view/findreplies',{urlParams:params,cache:!1})};factory.sendAnswer=function(posted_data){if(!this.value_id||!this.post_id){return $pwaRequest.reject('Missing value_id or post_id.')}
var data={value_id:this.value_id,post_id:this.post_id,edit_id:this.edit_id,answer_id:this.answer_id,reply_id:this.reply_id,first_level:this.first_level,posted_data:posted_data};return $pwaRequest.post('knowledge/mobile_edit/sendanswer',{data:data,cache:!1})};factory.addLike=function(){if(!this.value_id||!this.post_id){return $pwaRequest.reject('Missing value_id or post_id.')}
var data={value_id:this.value_id,post_id:this.post_id};return $pwaRequest.post('knowledge/mobile_edit/addlike',{data:data,cache:!1})};factory.addReplyLike=function(){if(!this.value_id||!this.post_id||!this.comment_id){return $pwaRequest.reject('Missing value_id or post_id or comment_id.')}
var data={value_id:this.value_id,post_id:this.post_id,comment_id:this.comment_id,first_level:this.first_level};return $pwaRequest.post('knowledge/mobile_edit/addreplylike',{data:data,cache:!1})};factory.deleteAnswer=function(delete_id){if(!this.value_id||!this.post_id||!delete_id){return $pwaRequest.reject('Missing value_id or post_id or delete_id.')}
var data={value_id:this.value_id,post_id:this.post_id,delete_id:delete_id};return $pwaRequest.post('knowledge/mobile_edit/deleteanswer',{data:data,cache:!1})};factory.deleteReply=function(delete_id){if(!this.value_id||!this.post_id||!delete_id){return $pwaRequest.reject('Missing value_id or post_id or delete_id.')}
var data={value_id:this.value_id,post_id:this.post_id,delete_id:delete_id};return $pwaRequest.post('knowledge/mobile_edit/deletereply',{data:data,cache:!1})};factory.deletePost=function(post_id){if(!this.value_id||!post_id){return $pwaRequest.reject('Missing value_id or post_id.')}
var data={value_id:this.value_id,post_id:post_id};return $pwaRequest.post('knowledge/mobile_edit/deletepost',{data:data,cache:!1})};factory.uploadImage=function(imageToSend){var data={imageToSend:imageToSend};return $pwaRequest.post('knowledge/mobile_view/uploadimage',{data:data,cache:!1})};factory.sendPostStatus=function(status,post_id){if(!this.value_id){return $pwaRequest.reject('Missing value_id.')}
var data={value_id:this.value_id,post_id:this.post_id,status:status};return $pwaRequest.post('knowledge/mobile_view/sendpoststatus',{data:data,cache:!1})};factory.set=function(subject,value){$window.localStorage.setItem(subject,value)};factory.get=function(subject){return $window.localStorage.getItem(subject)||null};factory.delete=function(subject){$window.localStorage.removeItem(subject)};return factory});angular.module('starter').filter('limitcharacter',function(){return function(text,length,end){if(!text){return}
if(isNaN(length)){length=10}
end=end||'...';if(text.length<=length||text.length-end.length<=length){return text}else{return String(text).substring(0,length-end.length)+end}}});Features.insertCSS(":root{--safe-area-inset-top:0;--safe-area-inset-right:0;--safe-area-inset-bottom:0;--safe-area-inset-left:0}@supports (padding-top:constant(safe-area-inset-top)){:root{--safe-area-inset-top:constant(safe-area-inset-top);--safe-area-inset-right:constant(safe-area-inset-right);--safe-area-inset-bottom:constant(safe-area-inset-bottom);--safe-area-inset-left:constant(safe-area-inset-left)}}@supports (padding-top:env(safe-area-inset-top)){:root{--safe-area-inset-top:env(safe-area-inset-top);--safe-area-inset-right:env(safe-area-inset-right);--safe-area-inset-bottom:env(safe-area-inset-bottom);--safe-area-inset-left:env(safe-area-inset-left)}}.platform-overview.platform-cordova{--safe-area-inset-top:1.5em;--safe-area-inset-right:0;--safe-area-inset-bottom:.5em;--safe-area-inset-left:0}.module-wordpress2 .post-content img{max-width:100%;height:auto}.module-wordpress2 .post-content p{margin-bottom:1em}.module-wordpress2 .post-content iframe{max-width:100%;height:auto}","knowledge")