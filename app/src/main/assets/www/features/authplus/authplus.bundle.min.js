angular.module('starter').controller('AuthplusController',function(Dialog,Loader,Customer,Authplus,$scope,$state,$stateParams,$translate){$scope.value_id=Authplus.value_id=$stateParams.value_id;$scope.customer_passcode_active=!1;$scope.customer_pin_is_set=!1;$scope.loadSettings=function(){Loader.show();Authplus.passcodeSettings().then(function(payload){$scope.payload=payload;if($scope.payload.customer_settings&&Customer.isLoggedIn()){if($scope.payload.customer_settings.is_passcode_active==1){$scope.customer_passcode_active=!0}else{$scope.customer_passcode_active=!1}
if($scope.payload.customer_settings.passcode!=''&&$scope.payload.customer_settings.passcode!=null&&$scope.payload.customer_settings.passcode.length==4){$scope.customer_pin_is_set=!0}}},function(error){Dialog.alert("Error",error.message,$translate.instant("OK","authplus"),-1,"authplus")}).then(function(){$scope.isLoading=!1;Loader.hide()})};$scope.UpdateStatus=function(){if($scope.customer_passcode_active){$scope.customer_passcode_active=!1}else{$scope.customer_passcode_active=!0;if($scope.customer_passcode_active&&!$scope.customer_pin_is_set){$state.go('authplus-pin',{value_id:$scope.value_id,type:'pin',value:1},{reload:!1})}}
if($scope.customer_pin_is_set){Loader.show();Authplus.changePasscodeStatus($scope.customer_passcode_active).then(function(payload){if($scope.customer_passcode_active&&!$scope.customer_pin_is_set){$state.go('authplus-pin',{value_id:$scope.value_id,type:'pin',value:1},{reload:!1})}},function(error){Dialog.alert("Error",error.message,$translate.instant("OK","authplus"),-1,"authplus")}).then(function(){Loader.hide()})}};$scope.toggleboxChange=function(){if(!Customer.isLoggedIn()){$scope.customer_passcode_active=!1;Customer.loginModal($scope,function(){$state.go('authplus',{value_id:$scope.value_id},{reload:!0})},function(){$state.go('authplus',{value_id:$scope.value_id},{reload:!0})},function(){$state.go('authplus',{value_id:$scope.value_id},{reload:!0})})}else{$scope.UpdateStatus()}};$scope.$on('$ionicView.enter',function(){$scope.loadSettings()});$scope.changePin=function(){$state.go('authplus-change-pin',{value_id:$scope.value_id,type:'changePin'},{reload:!1})}});angular.module('starter').controller('AuthplusAgeController',function(Dialog,$ionicNavBarDelegate,SB,Loader,Authplus,$scope,$state,$stateParams,Application,$translate){$scope.value_id=Authplus.value_id=$stateParams.value_id;$scope.is_not_allow=!1;$scope.is_test_mode=!1;$scope.no_button_action='';$scope.is_loading=!1;$scope.loadSettings=function(){Loader.show();$scope.is_loading=!0;Authplus.load().then(function(payload){$scope.payload=payload;$scope.box_height='#adjustHeight { min-height: 0px !important; height: '+$scope.payload.options.box_height+'vh !important; }';$scope.message_color='.item .authplus-messages, .item .authplus-heading-popup { color: '+$scope.payload.options.box_text_color+' !important; }';$scope.button_colors='.button.button.button-outline.authplus-yes-button { color: '+$scope.payload.options.button_text_color+' !important; background-color: '+$scope.payload.options.button_background_color+' !important; border-color: '+$scope.payload.options.button_border_color+' !important;  }';$scope.no_button_colors='.button.button.button-outline.authplus-no-button { color: '+$scope.payload.options.no_button_text_color+' !important; background-color: '+$scope.payload.options.no_button_background_color+' !important; border-color: '+$scope.payload.options.no_button_border_color+' !important;  }';if($scope.payload.data.is_test_mode=='1'){$scope.is_test_mode=!0}
$scope.no_button_action=$scope.payload.data.no_button_action},function(error){Dialog.alert($translate.instant("Error","authplus"),error.message,$translate.instant("OK","authplus"),-1,"authplus")}).then(function(){$scope.is_loading=!1;Loader.hide()})}
$scope.$on('$ionicView.enter',function(){$ionicNavBarDelegate.showBackButton(!1);$scope.loadSettings()});$scope.$on('$ionicView.leave',function(){$ionicNavBarDelegate.showBackButton(!0)});$scope.notAllow=function(){if($scope.no_button_action==2){if(DEVICE_TYPE!==SB.DEVICE.TYPE_BROWSER){navigator.app.exitApp()}else{Dialog.alert($translate.instant("Error","authplus"),$translate.instant("This feature is disable on webview!","authplus"),$translate.instant("Dismiss","authplus"),2350)}}else{$scope.is_not_allow=!0}}
$scope.allow=function(){$ionicNavBarDelegate.showBackButton(!0);localStorage.setItem('is_authplus_age_verification_'+Application.app_id,'verified');$state.go('home')}});angular.module('starter').controller('AuthplusPinController',function(Dialog,Loader,Customer,Authplus,$scope,$state,$stateParams,$timeout,$translate){$scope.value_id=Authplus.value_id=$stateParams.value_id;$scope.init=function(){$scope.passcode="";$scope.is_save_active=!0;if(!Customer.isLoggedIn()){$state.go('authplus',{value_id:$scope.value_id},{reload:!1})}};$scope.add=function(value){if($scope.passcode.length<4){$scope.passcode=$scope.passcode+value;if($scope.passcode.length==4){$timeout(function(){$scope.is_save_active=!1},500)}}};$scope.delete=function(){if($scope.passcode.length>0){$scope.passcode=$scope.passcode.substring(0,$scope.passcode.length-1);$scope.is_save_active=!0}};$scope.savePin=function(){Loader.show();Authplus.savePin($scope.passcode).then(function(payload){Dialog.alert($translate.instant("Success","authplus"),$translate.instant("The PIN has beed created successfully!","authplus"),$translate.instant("OK","authplus"),-1,'authplus').then(function(){$state.go('home',{},{reload:!1})})},function(error){Dialog.alert($translate.instant("Error","authplus"),error.message,$translate.instant("OK","authplus"),-1,"authplus")}).then(function(){Loader.hide()})}});angular.module('starter').controller('AuthplusPinLoginController',function(Dialog,Application,$ionicNavBarDelegate,Loader,Customer,Authplus,$scope,$state,$stateParams,$timeout,$translate){$scope.value_id=Authplus.value_id=$stateParams.value_id;$scope.customer_pin_set='';$scope.customer_name='';$scope.loadSettings=function(){Loader.show();Authplus.passcodeSettings().then(function(payload){$scope.payload=payload;if($scope.payload.customer_settings&&Customer.isLoggedIn()){if($scope.payload.customer_settings.is_passcode_active==0){$state.go('home',{},{reload:!1})}
if($scope.payload.customer_settings.passcode!=''&&$scope.payload.customer_settings.passcode!=null&&$scope.payload.customer_settings.passcode.length==4){$scope.customer_pin_set=$scope.payload.customer_settings.passcode}else{$state.go('home',{},{reload:!1})}}else{$state.go('home',{},{reload:!1})}},function(error){Dialog.alert($translate.instant("Error","authplus"),error.message,$translate.instant("OK","authplus"),-1,"authplus")}).then(function(){$scope.isLoading=!1;Loader.hide()})};$scope.init=function(){$scope.passcode="";$scope.display_passcode="";$scope.is_save_active=!0;if(!Customer.isLoggedIn()){$state.go('home',{},{reload:!1})}
$scope.customer_name=Customer.customer.firstname+" "+Customer.customer.lastname};$scope.add=function(value){if($scope.passcode.length<4){$scope.passcode=$scope.passcode+value;$scope.display_passcode=$scope.display_passcode+'*';if($scope.passcode.length==4){$timeout(function(){$scope.is_save_active=!1},500)}}};$scope.delete=function(){if($scope.passcode.length>0){$scope.passcode=$scope.passcode.substring(0,$scope.passcode.length-1);$scope.display_passcode=$scope.display_passcode.substring(0,$scope.display_passcode.length-1);$scope.is_save_active=!0}};$scope.forgotPin=function(){$state.go('authplus-forgot-email',{value_id:$scope.value_id,type:'forgotPin'},{reload:!1})};$scope.loginPin=function(){if($scope.customer_pin_set==$scope.passcode){console.log("login now");localStorage.setItem('is_authplus_pin_verification_'+Application.app_id,'verified');$state.go('home',{},{reload:!1})}else{$scope.passcode="";$scope.display_passcode="";$scope.is_save_active=!1;Dialog.alert($translate.instant("Failed","authplus"),$translate.instant("Invalid PIN","authplus"),$translate.instant("OK","authplus"),-1,"authplus")}};$scope.$on('$ionicView.enter',function(){$scope.loadSettings();$ionicNavBarDelegate.showBackButton(!1)});$scope.$on('$ionicView.leave',function(){$ionicNavBarDelegate.showBackButton(!0)})});angular.module('starter').controller('AuthplusForgotController',function(Dialog,Loader,Customer,Authplus,$scope,$state,$stateParams){$scope.value_id=Authplus.value_id=$stateParams.value_id;$scope.customer_name=Customer.customer.firstname+" "+Customer.customer.lastname;$scope.init=function(){if(!Customer.isLoggedIn()){$state.go('home',{},{reload:!1})}
$scope.customer_email=Customer.customer.email};$scope.ResetPinNow=function(){Loader.show();Authplus.pinRequest().then(function(payload){Dialog.alert($translate.instant("Success","authplus"),$translate.instant("The PIN has beed send successfully!","authplus"),$translate.instant("OK","authplus"),-1,'authplus').then(function(){$state.go('authplus',{value_id:$scope.value_id},{reload:!1})})},function(error){Dialog.alert($translate.instant("Error","authplus"),error.message,$translate.instant("OK","authplus"),-1,'authplus')}).then(function(){Loader.hide()})}});angular.module('starter').controller('AuthplusChangePinController',function(Dialog,Loader,Customer,Authplus,$scope,$state,$stateParams,$timeout,$translate){$scope.value_id=Authplus.value_id=$stateParams.value_id;$scope.customer_pin_set='';$scope.customer_name='';$scope.is_new_pin_page=!1;$scope.loadSettings=function(){Loader.show();Authplus.passcodeSettings().then(function(payload){$scope.payload=payload;if($scope.payload.customer_settings&&Customer.isLoggedIn()){if($scope.payload.customer_settings.is_passcode_active==0){$state.go('authplus',{value_id:$scope.value_id},{reload:!1})}
if($scope.payload.customer_settings.passcode!=''&&$scope.payload.customer_settings.passcode!=null&&$scope.payload.customer_settings.passcode.length==4){$scope.customer_pin_set=$scope.payload.customer_settings.passcode}else{$state.go('authplus',{value_id:$scope.value_id},{reload:!1})}}else{$state.go('authplus',{value_id:$scope.value_id},{reload:!1})}},function(error){Dialog.alert($translate.instant("Error","authplus"),error.message,$translate.instant("OK","authplus"),-1,"authplus")}).then(function(){$scope.isLoading=!1;Loader.hide()})};$scope.init=function(){$scope.passcode="";$scope.display_passcode="";$scope.is_save_active=!0;if(!Customer.isLoggedIn()){$state.go('home',{},{reload:!1})}
$scope.customer_name=Customer.customer.firstname+" "+Customer.customer.lastname};$scope.add=function(value){if($scope.passcode.length<4){$scope.passcode=$scope.passcode+value;$scope.display_passcode=$scope.display_passcode+'*';if($scope.passcode.length==4){$timeout(function(){$scope.is_save_active=!1},500)}}};$scope.delete=function(){if($scope.passcode.length>0){$scope.passcode=$scope.passcode.substring(0,$scope.passcode.length-1);$scope.display_passcode=$scope.display_passcode.substring(0,$scope.display_passcode.length-1);$scope.is_save_active=!0}};$scope.oldPinVerify=function(){if($scope.customer_pin_set==$scope.passcode){$scope.is_new_pin_page=!0}else{Dialog.alert($translate.instant("Failed","authplus"),$translate.instant("Invalid PIN","authplus"),$translate.instant("OK","authplus"),-1,"authplus")}
$scope.passcode="";$scope.display_passcode="";$scope.is_save_active=!1};$scope.PinVerify=function(){if($scope.is_new_pin_page){$scope.newPinVerify()}else{$scope.oldPinVerify()}};$scope.newPinVerify=function(){Loader.show();Authplus.savePin($scope.passcode).then(function(payload){Dialog.alert($translate.instant("Success","authplus"),$translate.instant("The PIN has beed changed successfully!","authplus"),$translate.instant("OK","authplus"),-1,'authplus').then(function(){$state.go('authplus',{value_id:$scope.value_id},{reload:!1})})},function(error){Dialog.alert($translate.instant("Error","authplus"),error.message,$translate.instant("OK","authplus"),-1,'authplus')}).then(function(){Loader.hide()})};$scope.$on('$ionicView.enter',function(){$scope.loadSettings()})});angular.module('starter').factory('Authplus',function(Application,Pages,Customer,$state,$pwaRequest,$ionicPlatform,$session,Dialog,SB,$ionicPopup,$translate){var factory={};factory.value_id=null;factory.age_value=null;factory.setValueId=function(valueId){factory.value_id=valueId;return factory};factory.getValueId=function(){return factory.value_id};factory.onStart=function(){Application.loaded.then(function(){var authplus=_.find(Pages.getActivePages(),{code:'authplus'});if(!authplus){return}
factory.setValueId(authplus.value_id).load().then(function(success){var data=success.data;var customer_settings=success.customer_settings;if(data.is_test_mode=='1'){localStorage.setItem('is_authplus_age_verification_'+Application.app_id,'');localStorage.setItem('authplus_popup_active_'+Application.app_id,'')}
setInterval(function(){if(data.is_age_verification_active==1&&data.age_layout==2&&localStorage.getItem('is_authplus_age_verification_'+Application.app_id)!='verified'&&localStorage.getItem('authplus_popup_active_'+Application.app_id)!='yes'){localStorage.setItem('authplus_popup_active_'+Application.app_id,'yes');Dialog.confirm(data.heading_popup,data.heading,[$translate.instant("YES","authplus"),$translate.instant("NO","authplus")],"Authplus-popup",'context').then(function(result){if(result){localStorage.setItem('is_authplus_age_verification_'+Application.app_id,'verified')}else{if(DEVICE_TYPE!==SB.DEVICE.TYPE_BROWSER){navigator.app.exitApp()}else{Dialog.alert($translate.instant("Error","authplus"),$translate.instant("This feature is disable on webview!","authplus"),$translate.instant("Dismiss","authplus"),2350)}}
localStorage.setItem('authplus_popup_active_'+Application.app_id,'')})}
if(data.is_age_verification_active==1&&data.age_layout==3&&localStorage.getItem('is_authplus_age_verification_'+Application.app_id)!='verified'&&localStorage.getItem('authplus_popup_active_'+Application.app_id)!='yes'){localStorage.setItem('authplus_popup_active_'+Application.app_id,'yes');var age_verification_min=data.age_verification_min;var customTemplate='<label class="item item-input"><input type="tel" class="input-popup-age" autocomplete="off"  type="text" ng-model="age_value" check-age placeholder="Enter Your Age" required></label>';var agePopup=$ionicPopup.show({template:customTemplate,title:data.heading_popup,subTitle:data.heading,cssClass:'authplus age-popup-layout3',buttons:[{text:$translate.instant("Verify","authplus"),type:'button button-positive button-positive-custom',onTap:function(e){if(factory.age_value!=''&&factory.age_value!=null){if(age_verification_min<=factory.age_value){localStorage.setItem('is_authplus_age_verification_'+Application.app_id,'verified');localStorage.setItem('authplus_popup_active_'+Application.app_id,'')}else{var fail_message=data.fail_message;if(fail_message==''||fail_message==null){fail_message='You are not eligible to enter into this app!'}
Dialog.alert('Failed',fail_message,["OK"],"Authplus-popup",'context').then(function(result){if(result){if(DEVICE_TYPE!==SB.DEVICE.TYPE_BROWSER){localStorage.setItem('authplus_popup_active_'+Application.app_id,'');navigator.app.exitApp()}else{Dialog.alert('Error',"This feature is disable on webview!",["OK"],"Authplus-popup",'context').then(function(result){localStorage.setItem('authplus_popup_active_'+Application.app_id,'')})}}})}
factory.age_value=''}else{localStorage.setItem('authplus_popup_active_'+Application.app_id,'')}}}]})}
if(data.is_age_verification_active==1&&data.age_layout==1&&localStorage.getItem('is_authplus_age_verification_'+Application.app_id)!='verified'&&$state.current.name!='authplus-age'){$state.go('authplus-age',{value_id:authplus.value_id,type:"age"},{reload:!1})}
var notState=['authplus-age','authplus-pin-login','authplus-forgot-email'];if(data.is_passcode_active==1&&localStorage.getItem('is_authplus_pin_verification_'+Application.app_id)!='verified'&&customer_settings&&Customer.isLoggedIn()&&notState.indexOf($state.current.name)===-1){if(customer_settings.is_passcode_active==1&&customer_settings.passcode.length==4){$state.go('authplus-pin-login',{value_id:authplus.value_id,type:"pin",value:2,status:1},{reload:!1})}}},1000)}).catch(function(error){console.error('authplus-error',error)})})};factory.pinRequest=function(){var params={};return $sbhttp({method:'GET',url:Url.get('authplus/mobile_view/pinrequest',params),cache:!1,responseType:'json'})};factory.load=function(){return $pwaRequest.get('authplus/mobile_view/find',{data:{},cache:!1,})};factory.passcodeSettings=function(){return $pwaRequest.get('authplus/mobile_view/passcodesettings',{data:{},cache:!1,})};factory.changePasscodeStatus=function(is_active){return $pwaRequest.post('authplus/mobile_view/changepasscodestatus',{data:{is_active:is_active,value_id:factory.value_id}})};factory.savePin=function(passcode){return $pwaRequest.post('authplus/mobile_view/savepin',{data:{passcode:passcode,value_id:factory.value_id}})};factory.getsetting=function(){return $pwaRequest.get('authplus/mobile_view/getsetting',{data:{},cache:!1})};$ionicPlatform.on('pause',function(){localStorage.setItem('is_authplus_pin_verification_'+Application.app_id,'')});return factory});"use strict";angular.module('starter').directive('authplushBgColor',function($timeout){return{restrict:'A',link:function(scope,element,attrs){$timeout(function(){var image='';scope.$watch('payload.data.background_image',function(value){if(value!=undefined&&value!="_delete_"&&value!=""){image=IMAGE_URL+'images/application'+value;element.css({'background-image':'url('+image+')'})}});scope.$watch('payload.options.box_icon_color',function(value){if(value!=undefined&&value!=""){element.css({'background-color':value})}})},1000)}}});angular.module('starter').directive('checkAge',function(Authplus){return{require:'ngModel',link:function(scope,element,attr,ngModelCtrl){element.bind('input',function(){var currentValue=element.val();Authplus.age_value=currentValue;console.log(currentValue)})}}});Features.insertCSS(":root{--safe-area-inset-top:0;--safe-area-inset-right:0;--safe-area-inset-bottom:0;--safe-area-inset-left:0}@supports (padding-top:constant(safe-area-inset-top)){:root{--safe-area-inset-top:constant(safe-area-inset-top);--safe-area-inset-right:constant(safe-area-inset-right);--safe-area-inset-bottom:constant(safe-area-inset-bottom);--safe-area-inset-left:constant(safe-area-inset-left)}}@supports (padding-top:env(safe-area-inset-top)){:root{--safe-area-inset-top:env(safe-area-inset-top);--safe-area-inset-right:env(safe-area-inset-right);--safe-area-inset-bottom:env(safe-area-inset-bottom);--safe-area-inset-left:env(safe-area-inset-left)}}.platform-overview.platform-cordova{--safe-area-inset-top:1.5em;--safe-area-inset-right:0;--safe-area-inset-bottom:.5em;--safe-area-inset-left:0}.authplus .authplus-no-yes-button{margin-top:15%}.authplus .item .authplus-messages{font-size:18px;margin-top:10%}.authplus .item .authplus-heading-popup{font-size:22px;font-weight:700}.authplus.authplus-age-verification .item{border-width:0;background:transparent}.authplus .button.button-outline.authplus-yes-button{margin-left:10%}.authplus .button.button-outline.authplus-no-button{margin-right:10%}.authplus .authplus-av-content{background-color:transparent!important}.authplus .authplus .authplus-age-verification{background-position:center center!important;background-size:cover!important;background-repeat:no-repeat!important}.authplus .pin-input{border-bottom:1px solid!important;text-align:center!important;padding-right:0px!important}.authplus .pin-input-item{border-color:transparent!important}.authplus .center-vertical{-webkit-box-direction:normal;-moz-box-direction:normal;-webkit-box-orient:horizontal;-moz-box-orient:horizontal;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-flex-wrap:nowrap;-ms-flex-wrap:nowrap;flex-wrap:nowrap;-webkit-box-pack:center;-moz-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-content:stretch;-ms-flex-line-pack:stretch;align-content:stretch;-webkit-box-align:center;-moz-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}.authplus .center-vertical>*{-webkit-box-ordinal-group:1;-moz-box-ordinal-group:1;-webkit-order:0;-ms-flex-order:0;order:0;-webkit-box-flex:1;-moz-box-flex:1;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;-webkit-align-self:auto;-ms-flex-item-align:auto;align-self:auto}.authplus .pin-section{margin-top:15%;font-size:28px}.authplus .keyboard-section{margin-top:15%}.authplus p.pin-fogot-title{font-size:14px;margin-top:20px;color:#9e9e9e}.authplus .popup .popup-body .input-popup-age{border-bottom:0 solid rgba(0,122,255,0)!important;text-align:center}","authplus")